{"ast":null,"code":"import { put, takeLatest } from 'redux-saga/effects';\nimport { messagesLoaded } from '../actions';\nconst messageDetails = {\n  '2': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Ok fair enough. Well good talking to you.',\n    createdAt: 'Oct 20',\n    isMyMessage: true\n  }, {\n    id: '2',\n    imageUrl: require('../../images/profiles/kim.jpeg'),\n    imageAlt: 'Kim O\\'Neil',\n    messageText: `\n                Not sure exactly yet. It will be next year sometime. Probably late.\n            `,\n    createdAt: 'Oct 20',\n    isMyMessage: false\n  }, {\n    id: '3',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Yeah I know. But oh well. So when is the big date?',\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }, {\n    id: '4',\n    imageUrl: require('../../images/profiles/kim.jpeg'),\n    imageAlt: 'Kim O\\'Neil',\n    messageText: `\n                Well I know you like doing that stuff. But honestly I think\n                you are already really talented. It's a shame you haven't found\n                what you are looking for yet.\n            `,\n    createdAt: 'Oct 19',\n    isMyMessage: false\n  }, {\n    id: '5',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: `\n                I'm doing ok. Just working on building some applications to\n                bulk up my resume, so I can get a better job.\n            `,\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }, {\n    id: '6',\n    imageUrl: require('../../images/profiles/kim.jpeg'),\n    imageAlt: 'Kim O\\'Neil',\n    messageText: `\n                I've just been really busy at work myself, looking to get\n                married sometime next year too. How are you going?\n            `,\n    createdAt: 'Oct 19',\n    isMyMessage: false\n  }, {\n    id: '7',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Yes it has been a little while',\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }, {\n    id: '8',\n    imageUrl: require('../../images/profiles/kim.jpeg'),\n    imageAlt: 'Kim O\\'Neil',\n    messageText: 'Hey!!!! Have not spoken to you for a while',\n    createdAt: 'Oct 19',\n    isMyMessage: false\n  }, {\n    id: '9',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi Kim?',\n    createdAt: 'Oct 19',\n    isMyMessage: true\n  }],\n  '3': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '4': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '5': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '6': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '7': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '8': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }],\n  '9': [{\n    id: '1',\n    imageUrl: null,\n    imageAlt: null,\n    messageText: 'Hi',\n    createdAt: '1 week ago',\n    isMyMessage: true\n  }]\n};\n\nconst delay = ms => new Promise(res => setTimeout(res, ms));\n\nconst messagesSaga = function* (action) {\n  const {\n    conversationId,\n    numberOfMessages,\n    lastMessageId\n  } = action.payload;\n  const messages = messageDetails[conversationId];\n  const startIndex = lastMessageId ? messages.findIndex(message => message.id === lastMessageId) + 1 : 0;\n  const endIndex = startIndex + numberOfMessages;\n  const pageGroup = messages.slice(startIndex, endIndex);\n  const newLastMessageId = pageGroup.length > 0 ? pageGroup[pageGroup.length - 1].id : null;\n  const hasMoreMessages = newLastMessageId && endIndex < messages.length - 1;\n  yield delay(1000);\n  yield put(messagesLoaded(conversationId, pageGroup, hasMoreMessages, newLastMessageId));\n\n  if (hasMoreMessages) {\n    yield delay(1000);\n    yield put({\n      type: 'MESSAGES_REQUESTED',\n      payload: {\n        conversationId,\n        numberOfMessages,\n        lastMessageId: newLastMessageId\n      }\n    });\n  }\n};\n\nexport const watchGetMessagesAsync = function* () {\n  yield takeLatest('MESSAGES_REQUESTED', messagesSaga);\n};","map":{"version":3,"names":["put","takeLatest","messagesLoaded","messageDetails","id","imageUrl","imageAlt","messageText","createdAt","isMyMessage","require","delay","ms","Promise","res","setTimeout","messagesSaga","action","conversationId","numberOfMessages","lastMessageId","payload","messages","startIndex","findIndex","message","endIndex","pageGroup","slice","newLastMessageId","length","hasMoreMessages","type","watchGetMessagesAsync"],"sources":["C:/Users/LENOVO/Projects/chat-app-react/src/store/sagas/messages.js"],"sourcesContent":["import { put, takeLatest } from 'redux-saga/effects';\r\n\r\nimport { messagesLoaded } from '../actions';\r\n\r\nconst messageDetails = {\r\n    '2': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Ok fair enough. Well good talking to you.',\r\n            createdAt: 'Oct 20',\r\n            isMyMessage: true\r\n        },\r\n        {\r\n            id: '2',\r\n            imageUrl: require('../../images/profiles/kim.jpeg'),\r\n            imageAlt: 'Kim O\\'Neil',\r\n            messageText: `\r\n                Not sure exactly yet. It will be next year sometime. Probably late.\r\n            `,\r\n            createdAt: 'Oct 20',\r\n            isMyMessage: false\r\n        },\r\n        {\r\n            id: '3',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Yeah I know. But oh well. So when is the big date?',\r\n            createdAt: 'Oct 19',\r\n            isMyMessage: true\r\n        },\r\n        {\r\n            id: '4',\r\n            imageUrl: require('../../images/profiles/kim.jpeg'),\r\n            imageAlt: 'Kim O\\'Neil',\r\n            messageText: `\r\n                Well I know you like doing that stuff. But honestly I think\r\n                you are already really talented. It's a shame you haven't found\r\n                what you are looking for yet.\r\n            `,\r\n            createdAt: 'Oct 19',\r\n            isMyMessage: false\r\n        },\r\n        {\r\n            id: '5',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: `\r\n                I'm doing ok. Just working on building some applications to\r\n                bulk up my resume, so I can get a better job.\r\n            `,\r\n            createdAt: 'Oct 19',\r\n            isMyMessage: true\r\n        },\r\n        {\r\n            id: '6',\r\n            imageUrl: require('../../images/profiles/kim.jpeg'),\r\n            imageAlt: 'Kim O\\'Neil',\r\n            messageText: `\r\n                I've just been really busy at work myself, looking to get\r\n                married sometime next year too. How are you going?\r\n            `,\r\n            createdAt: 'Oct 19',\r\n            isMyMessage: false\r\n        },\r\n        {\r\n            id: '7',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Yes it has been a little while',\r\n            createdAt: 'Oct 19',\r\n            isMyMessage: true\r\n        },\r\n        {\r\n            id: '8',\r\n            imageUrl: require('../../images/profiles/kim.jpeg'),\r\n            imageAlt: 'Kim O\\'Neil',\r\n            messageText: 'Hey!!!! Have not spoken to you for a while',\r\n            createdAt: 'Oct 19',\r\n            isMyMessage: false\r\n        },\r\n        {\r\n            id: '9',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi Kim?',\r\n            createdAt: 'Oct 19',\r\n            isMyMessage: true\r\n        }\r\n    ],\r\n    '3': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi',\r\n            createdAt: '1 week ago',\r\n            isMyMessage: true\r\n        }\r\n    ],\r\n    '4': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi',\r\n            createdAt: '1 week ago',\r\n            isMyMessage: true\r\n        }\r\n    ],\r\n    '5': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi',\r\n            createdAt: '1 week ago',\r\n            isMyMessage: true\r\n        }\r\n    ],\r\n    '6': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi',\r\n            createdAt: '1 week ago',\r\n            isMyMessage: true\r\n        }\r\n    ],\r\n    '7': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi',\r\n            createdAt: '1 week ago',\r\n            isMyMessage: true\r\n        }\r\n    ],\r\n    '8': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi',\r\n            createdAt: '1 week ago',\r\n            isMyMessage: true\r\n        }\r\n    ],\r\n    '9': [\r\n        {\r\n            id: '1',\r\n            imageUrl: null,\r\n            imageAlt: null,\r\n            messageText: 'Hi',\r\n            createdAt: '1 week ago',\r\n            isMyMessage: true\r\n        }\r\n    ]\r\n};\r\n\r\nconst delay = (ms) => new Promise(res => setTimeout(res, ms));\r\n\r\nconst messagesSaga = function*(action) {\r\n    const { conversationId, numberOfMessages, lastMessageId } = action.payload;\r\n    const messages = messageDetails[conversationId];\r\n    const startIndex = lastMessageId ? messages.findIndex(message => message.id === lastMessageId) + 1: 0;\r\n    const endIndex = startIndex + numberOfMessages;\r\n    const pageGroup = messages.slice(startIndex, endIndex);\r\n    const newLastMessageId = pageGroup.length > 0 ? pageGroup[pageGroup.length - 1].id: null;\r\n    const hasMoreMessages = newLastMessageId && endIndex < (messages.length - 1);\r\n\r\n    yield delay(1000);\r\n\r\n    yield put(messagesLoaded(\r\n        conversationId,\r\n        pageGroup,\r\n        hasMoreMessages,\r\n        newLastMessageId\r\n    ));\r\n\r\n    if (hasMoreMessages) {\r\n        yield delay(1000);\r\n        yield put({\r\n            type: 'MESSAGES_REQUESTED',\r\n            payload: {\r\n                conversationId,\r\n                numberOfMessages,\r\n                lastMessageId: newLastMessageId\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nexport const watchGetMessagesAsync = function*() {\r\n    yield takeLatest('MESSAGES_REQUESTED', messagesSaga);\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}